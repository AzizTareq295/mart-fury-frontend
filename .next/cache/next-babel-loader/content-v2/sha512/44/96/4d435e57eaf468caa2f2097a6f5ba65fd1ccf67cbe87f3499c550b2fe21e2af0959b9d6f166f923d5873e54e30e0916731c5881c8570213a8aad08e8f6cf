{"ast":null,"code":"import { all, put, takeEvery } from 'redux-saga/effects';\nimport { notification } from 'antd';\nimport { actionTypes, getCartError, getCartSuccess, updateCartSuccess, updateCartError } from './action';\n\nconst modalSuccess = type => {\n  notification[type]({\n    message: 'Success',\n    description: 'This product has been added to your cart!',\n    duration: 1\n  });\n};\n\nconst modalWarning = type => {\n  notification[type]({\n    message: 'Remove A Item',\n    description: 'This product has been removed from your cart!',\n    duration: 1\n  });\n};\n\nexport const calculateAmount = obj => Object.values(obj).reduce((acc, product) => acc + product.quantity * product.price, 0).toFixed(2);\n\nfunction* getCartSaga() {\n  try {\n    yield put(getCartSuccess());\n  } catch (err) {\n    yield put(getCartError(err));\n  }\n}\n\nfunction* addItemSaga(payload) {\n  try {\n    const {\n      product\n    } = payload;\n    const item = {\n      id: product.id,\n      name: product.name,\n      slug: product.slug,\n      sku: product.sku[0].sku,\n      sku_id: product.sku[0].id,\n      regular_price: product.sku[0].regular_price,\n      sell_price: product.sku[0].sell_price,\n      price: product.sku[0].sell_price > 0 ? product.sku[0].sell_price : product.sku[0].regular_price,\n      product_stock: product.sku[0].stock,\n      thumbnail: product.product_media.feature_img,\n      quantity: 1\n    };\n    const localCart = JSON.parse(localStorage.getItem('persist:martfury')).cart;\n    let currentCart = JSON.parse(localCart);\n    let existItem = currentCart.cartItems.find(p => parseInt(p.id) === parseInt(item.id));\n\n    if (existItem) {\n      existItem.quantity += item.quantity;\n    } else {\n      if (!item.quantity) {\n        item.quantity = 1;\n      }\n\n      currentCart.cartItems.push(item);\n    }\n\n    currentCart.amount = calculateAmount(currentCart.cartItems);\n    currentCart.cartTotal++;\n    yield put(updateCartSuccess(currentCart));\n    modalSuccess('success');\n  } catch (err) {\n    yield put(getCartError(err));\n  }\n}\n\nfunction* removeItemSaga(payload) {\n  try {\n    const {\n      product\n    } = payload;\n    let localCart = JSON.parse(JSON.parse(localStorage.getItem('persist:martfury')).cart);\n    let index = localCart.cartItems.findIndex(p => parseInt(p.id) === parseInt(product.id));\n    localCart.cartTotal = localCart.cartTotal - product.quantity;\n    localCart.cartItems.splice(index, 1);\n    localCart.amount = calculateAmount(localCart.cartItems);\n\n    if (localCart.cartItems.length === 0) {\n      localCart.cartItems = [];\n      localCart.amount = 0;\n      localCart.cartTotal = 0;\n    }\n\n    yield put(updateCartSuccess(localCart));\n    modalWarning('warning');\n  } catch (err) {\n    yield put(getCartError(err));\n  }\n}\n\nfunction* increaseQtySaga(payload) {\n  try {\n    const {\n      product\n    } = payload;\n    let localCart = JSON.parse(JSON.parse(localStorage.getItem('persist:martfury')).cart);\n    let selectedItem = localCart.cartItems.find(p => parseInt(p.id) === parseInt(product.id));\n    console.log(selectedItem);\n\n    if (selectedItem) {\n      selectedItem.quantity++;\n      localCart.cartTotal++;\n      localCart.amount = calculateAmount(localCart.cartItems);\n    }\n\n    yield put(updateCartSuccess(localCart));\n  } catch (err) {\n    yield put(getCartError(err));\n  }\n}\n\nfunction* decreaseItemQtySaga(payload) {\n  try {\n    const {\n      product\n    } = payload;\n    const localCart = JSON.parse(JSON.parse(localStorage.getItem('persist:martfury')).cart);\n    let selectedItem = localCart.cartItems.find(p => parseInt(p.id) === parseInt(product.id));\n\n    if (selectedItem) {\n      selectedItem.quantity--;\n      localCart.cartTotal--;\n      localCart.amount = calculateAmount(localCart.cartItems);\n    }\n\n    yield put(updateCartSuccess(localCart));\n  } catch (err) {\n    yield put(getCartError(err));\n  }\n}\n\nfunction* clearCartSaga() {\n  try {\n    const emptyCart = {\n      cartItems: [],\n      amount: 0,\n      cartTotal: 0\n    };\n    yield put(updateCartSuccess(emptyCart));\n  } catch (err) {\n    yield put(updateCartError(err));\n  }\n}\n\nexport default function* rootSaga() {\n  yield all([takeEvery(actionTypes.GET_CART, getCartSaga)]);\n  yield all([takeEvery(actionTypes.ADD_ITEM, addItemSaga)]);\n  yield all([takeEvery(actionTypes.REMOVE_ITEM, removeItemSaga)]);\n  yield all([takeEvery(actionTypes.INCREASE_QTY, increaseQtySaga)]);\n  yield all([takeEvery(actionTypes.DECREASE_QTY, decreaseItemQtySaga)]);\n}","map":{"version":3,"sources":["D:/laragon/www/brand-freak-frontend/store/cart/saga.js"],"names":["all","put","takeEvery","notification","actionTypes","getCartError","getCartSuccess","updateCartSuccess","updateCartError","modalSuccess","type","message","description","duration","modalWarning","calculateAmount","obj","Object","values","reduce","acc","product","quantity","price","toFixed","getCartSaga","err","addItemSaga","payload","item","id","name","slug","sku","sku_id","regular_price","sell_price","product_stock","stock","thumbnail","product_media","feature_img","localCart","JSON","parse","localStorage","getItem","cart","currentCart","existItem","cartItems","find","p","parseInt","push","amount","cartTotal","removeItemSaga","index","findIndex","splice","length","increaseQtySaga","selectedItem","console","log","decreaseItemQtySaga","clearCartSaga","emptyCart","rootSaga","GET_CART","ADD_ITEM","REMOVE_ITEM","INCREASE_QTY","DECREASE_QTY"],"mappings":"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","sourcesContent":["import { all, put, takeEvery } from 'redux-saga/effects';\nimport { notification } from 'antd';\n\nimport {\n    actionTypes,\n    getCartError,\n    getCartSuccess,\n    updateCartSuccess,\n    updateCartError,\n} from './action';\n\nconst modalSuccess = (type) => {\n    notification[type]({\n        message: 'Success',\n        description: 'This product has been added to your cart!',\n        duration: 1,\n    });\n};\nconst modalWarning = (type) => {\n    notification[type]({\n        message: 'Remove A Item',\n        description: 'This product has been removed from your cart!',\n        duration: 1,\n    });\n};\n\nexport const calculateAmount = (obj) =>\n    Object.values(obj)\n        .reduce((acc, product) => acc + product.quantity * product.price, 0)\n        .toFixed(2);\n\nfunction* getCartSaga() {\n    try {\n        yield put(getCartSuccess());\n    } catch (err) {\n        yield put(getCartError(err));\n    }\n}\n\nfunction* addItemSaga(payload) {\n    try {\n        const { product } = payload;\n        const item = {\n            id: product.id,\n            name: product.name,\n            slug: product.slug,\n            sku: product.sku[0].sku,\n            sku_id: product.sku[0].id,\n            regular_price: product.sku[0].regular_price,\n            sell_price: product.sku[0].sell_price,\n            price: product.sku[0].sell_price > 0 ? product.sku[0].sell_price : product.sku[0].regular_price,\n            product_stock: product.sku[0].stock,\n            thumbnail: product.product_media.feature_img,\n            quantity: 1,\n        }\n        const localCart = JSON.parse(localStorage.getItem('persist:martfury'))\n            .cart;\n        let currentCart = JSON.parse(localCart);\n        let existItem = currentCart.cartItems.find(\n            (p) => parseInt(p.id) === parseInt(item.id)\n        );\n        \n        if (existItem) {\n            existItem.quantity += item.quantity;\n        } else {\n            if (!item.quantity) {\n                item.quantity = 1;\n            }\n            currentCart.cartItems.push(item);\n        }\n        currentCart.amount = calculateAmount(currentCart.cartItems);\n        currentCart.cartTotal++;\n        yield put(updateCartSuccess(currentCart));\n        modalSuccess('success');\n    } catch (err) {\n        yield put(getCartError(err));\n    }\n}\n\nfunction* removeItemSaga(payload) {\n    try {\n        const { product } = payload;\n\n        let localCart = JSON.parse(\n            JSON.parse(localStorage.getItem('persist:martfury')).cart\n        );\n        let index = localCart.cartItems.findIndex(\n            (p) => parseInt(p.id) === parseInt(product.id)\n        );\n        \n        localCart.cartTotal = localCart.cartTotal - product.quantity;\n        localCart.cartItems.splice(index, 1);\n        localCart.amount = calculateAmount(localCart.cartItems);\n        if (localCart.cartItems.length === 0) {\n            localCart.cartItems = [];\n            localCart.amount = 0;\n            localCart.cartTotal = 0;\n        }\n        yield put(updateCartSuccess(localCart));\n        modalWarning('warning');\n    } catch (err) {\n        yield put(getCartError(err));\n    }\n}\n\nfunction* increaseQtySaga(payload) {\n    try {\n        const { product } = payload;\n\n        let localCart = JSON.parse(\n            JSON.parse(localStorage.getItem('persist:martfury')).cart\n        );\n        let selectedItem = localCart.cartItems.find(\n            (p) => parseInt(p.id) === parseInt(product.id)\n        );\n        console.log(selectedItem);\n        if (selectedItem) {\n            selectedItem.quantity++;\n            localCart.cartTotal++;\n            localCart.amount = calculateAmount(localCart.cartItems);\n        }\n        yield put(updateCartSuccess(localCart));\n    } catch (err) {\n        yield put(getCartError(err));\n    }\n}\n\nfunction* decreaseItemQtySaga(payload) {\n    try {\n        const { product } = payload;\n\n        const localCart = JSON.parse(\n            JSON.parse(localStorage.getItem('persist:martfury')).cart\n        );\n        let selectedItem = localCart.cartItems.find(\n            (p) => parseInt(p.id) === parseInt(product.id)\n        );\n\n        if (selectedItem) {\n            selectedItem.quantity--;\n            localCart.cartTotal--;\n            localCart.amount = calculateAmount(localCart.cartItems);\n        }\n        yield put(updateCartSuccess(localCart));\n    } catch (err) {\n        yield put(getCartError(err));\n    }\n}\n\nfunction* clearCartSaga() {\n    try {\n        const emptyCart = {\n            cartItems: [],\n            amount: 0,\n            cartTotal: 0,\n        };\n        yield put(updateCartSuccess(emptyCart));\n    } catch (err) {\n        yield put(updateCartError(err));\n    }\n}\n\nexport default function* rootSaga() {\n    yield all([takeEvery(actionTypes.GET_CART, getCartSaga)]);\n    yield all([takeEvery(actionTypes.ADD_ITEM, addItemSaga)]);\n    yield all([takeEvery(actionTypes.REMOVE_ITEM, removeItemSaga)]);\n    yield all([takeEvery(actionTypes.INCREASE_QTY, increaseQtySaga)]);\n    yield all([takeEvery(actionTypes.DECREASE_QTY, decreaseItemQtySaga)]);\n}\n"]},"metadata":{},"sourceType":"module"}